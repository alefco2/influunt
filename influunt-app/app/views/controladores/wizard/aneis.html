<fieldset data-ng-init="inicializaAneis()">
  <div class="m-t-md">
    <div class="col-lg-12 col-sm-12 bg-border no-padding">
      <div class="ibox float-e-margins">
        <div class="col-lg-12 col-sm-12 padding-top-20 tabs-container">
          <influunt-tabs class="tabpanel"
                         data-on-add="ativarProximoAnel"
                         data-on-remove="desativarUltimoAnel"
                         data-on-activate="selecionaAnel"
                         data-aneis-ativos="aneisAtivos"
                         data-error-check="anelTemErro"
                         data-can-add-tabs="true"
                         data-max-tabs="objeto.limiteAnel"></influunt-tabs>
          <div class="ui-layout-content tab-content">
            <div id="tabs-1">
              <div class="row col-lg-12 col-sm-12">
                <div class="row col-lg-12 col-sm-12 padding-top-20">
                  <h3>{{ 'controladores.estagios' | translate }}</h3>
                </div>
                <uib-alert type="danger" close="closeAlert(currentAnelIndex)" data-ng-if="errors.aneis[currentAnelIndex].general">
                  <div style="padding-left: 12px;">
                    <ul>
                      <li data-ng-repeat="message in errors.general">{{ message }}</li>
                      <li data-ng-repeat="message in errors.aneis[currentAnelIndex].general">{{ message }}</li>
                    </ul>
                  </div>
                </uib-alert>
              </div>

              <div class="col-lg-12 col-sm-12 movements">
                <form class="dropzone"
                      id="my-awesome-dropzone"
                      imagens-url="dados.imagensUrl"
                      enctype="multipart/form-data"
                      influunt-dropzone
                      anel="currentAnel"
                      on-success="adicionarEstagio(upload, imagem)"
                      on-delete="removerEstagio(imagem)">
                  <fake-dropzone-preview aneis="aneis"></fake-dropzone-preview>
                  <div class="dz-default dz-message"><span>Clique ou Arraste imagens para este local</span></div>
                  <div class="fallback">
                    <input name="file" type="file" multiple />
                  </div>
                </form>
              </div>


              <div class="col-lg-12 col-sm-12 groups ibox-content no-padding padding-top-20">
                <div class="col-lg-6 col-sm-6 no-padding-left">
                  <div class="col-lg-12 col-sm-12">
                    <div class="form-group">
                      <label class="control-label">{{ 'controladores.localizacao' | translate }}</label>
                      <input type="text" name="localizacao" placeholder="" class="form-control" data-ng-model="currentAnel.localizacao" readonly></textarea>
                    </div>
                    <div class="form-group">
                      <label class="control-label">{{ 'controladores.numeroSMEE' | translate }}</label>
                      <input type="text" name="numeroSMEE" placeholder="" class="form-control" data-ng-model="currentAnel.numeroSMEE">
                    </div>
                    <div class="form-group">
                      <label class="control-label">{{ 'controladores.CLA' | translate }}</label>
                      <input type="text" name="CLA" class="form-control"
                        data-ng-model="currentAnel.CLA" readonly>
                    </div>
                  </div>
                </div>


                <div class="col-lg-6 col-sm-6">
                  <h4>CROQUI</h4>
                  <div class="img-preview img-preview-sm">
                    <img ng-if="currentAnel.croqui" ng-src="{{ currentAnel.croqui.id | imageSource }}" alt="{{ currentAnel.croqui.filename }}">
                  </div>
                  <div class="btn-group padding-top-20">
                    <influunt-image-input data-upload-url="dados.imagensUrl" data-on-upload="adicionarCroqui"></influunt-image-input>
                  </div>
                </div>

                <div class="col-lg-12 col-sm-12">
                  <div class="form-group">
                    <figure>
                      <div influunt-map
                        markers="currentEnderecos[0]"
                        class="influunt-map">
                      </div>
                    </figure>
                  </div>
                </div>

                <div class="col-lg-6 col-sm-6">
                  <div class="form-group" data-ng-class="{ 'has-error': errors.aneis[currentAnelIndex].enderecos[0].localizacao }">
                    <label class="control-label">{{ 'controladores.localizacao' | translate }} 1:</label>
                    <helper-endereco ng-model="currentEnderecos[0].localizacao" localizacao="currentEnderecos[0].localizacao" latitude="currentEnderecos[0].latitude" longitude="currentEnderecos[0].longitude"></helper-endereco>
                    <p class="help-block error-msg" data-ng-repeat="error in errors.aneis[currentAnelIndex].enderecos[0].localizacao">{{ error }}</p>
                  </div>
                  <div class="form-group" data-ng-class="{ 'has-error': errors.aneis[currentAnelIndex].enderecos[0].latitude }">
                    <label class="control-label">{{ 'controladores.latitude' | translate }}:</label>
                    <input type="number" name="enderecos[0].latitude" class="form-control" data-ng-model="currentEnderecos[0].latitude">
                    <p class="help-block error-msg" data-ng-repeat="error in errors.aneis[currentAnelIndex].enderecos[0].latitude">{{ error }}</p>
                  </div>
                  <div class="form-group" data-ng-class="{ 'has-error': errors.aneis[currentAnelIndex].enderecos[0].longitude }">
                    <label class="control-label">{{ 'controladores.longitude' | translate }}:</label>
                    <input type="number" name="enderecos[0].longitude" class="form-control" data-ng-model="currentEnderecos[0].longitude">
                    <p class="help-block error-msg" data-ng-repeat="error in errors.aneis[currentAnelIndex].enderecos[0].longitude">{{ error }}</p>
                  </div>
                </div>

                <div class="col-lg-6 col-sm-6">
                  <div class="form-group" data-ng-class="{ 'has-error': errors.aneis[currentAnelIndex].enderecos[1].localizacao }">
                    <label class="control-label">{{ 'controladores.localizacao' | translate }} 2:</label>
                    <helper-endereco ng-model="currentEnderecos[1].localizacao" localizacao="currentEnderecos[1].localizacao" latitude="currentEnderecos[1].latitude" longitude="currentEnderecos[1].longitude"></helper-endereco>
                    <p class="help-block error-msg" data-ng-repeat="error in errors.aneis[currentAnelIndex].enderecos[1].localizacao">{{ error }}</p>
                  </div>
                  <div class="form-group" data-ng-class="{ 'has-error': errors.aneis[currentAnelIndex].enderecos[1].latitude }">
                    <label class="control-label">{{ 'controladores.latitude' | translate }}:</label>
                    <input type="number" name="enderecos[1].latitude" class="form-control" data-ng-model="currentEnderecos[1].latitude">
                    <p class="help-block error-msg" data-ng-repeat="error in errors.aneis[currentAnelIndex].enderecos[1].latitude">{{ error }}</p>
                  </div>
                  <div class="form-group" data-ng-class="{ 'has-error': errors.aneis[currentAnelIndex].enderecos[1].longitude }">
                    <label class="control-label">{{ 'controladores.longitude' | translate }}:</label>
                    <input type="number" name="enderecos[1].longitude" class="form-control" data-ng-model="currentEnderecos[1].longitude">
                    <p class="help-block error-msg" data-ng-repeat="error in errors.aneis[currentAnelIndex].enderecos[1].longitude">{{ error }}</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

	<div class="row">
    <div class="col-lg-12 col-sm-12 bg-border-footer pg-bt-footer actions clearfix">
      <a data-toggle="modal" data-target="#myModal" class="left btn btn-info btn-footer" tooltips tooltip-template="{{ 'plugins.steps.labels.last_screen' | translate }}">
        <i class="fa fa-eye"></i> {{ 'plugins.steps.labels.last_screen' | translate }}
      </a>
      <div class="right">
        <a go-to-top data-ng-click="submitForm({$valid: true}, 'aneis', 'app.wizard_controladores.configuracao_grupo')" tooltips tooltip-template="Configuração de Grupo" class="go-to-top btn btn-primary btn-footer right">
          {{ 'plugins.steps.labels.saveNext' | translate }} <i class="fa fa-arrow-right"></i>
        </a>
      </div>
      <div class="right">
        <a data-ng-click="submitForm({$valid: true}, 'aneis', 'app.wizard_controladores.dados_basicos')" tooltips tooltip-template="Dados Básicos" class="btn btn-outline btn-primary btn-footer right m-r-sm right">
          <i class="fa fa-arrow-left"></i> {{ 'plugins.steps.labels.saveBack' | translate }}
        </a>
      </div>
      <div class="right">
        <a onclick="VoltarSemSalvar()" tooltips tooltip-template="Entre Verdes" class="btn btn-outline btn-primary btn-footer right m-r-sm right">
          <i class="fa fa-arrow-left"></i> {{ 'plugins.steps.labels.back' | translate }}
        </a>
        <script>
        VoltarSemSalvar = function() {
            var x;
            if (confirm("Ao voltar os dados não serão salvos") == true) {
                x = window.history.back();
              } else {
                  x = null;
                }
            }
        </script>
      </div>
    </div>
  </div>
</fieldset>


<div class="modal inmodal" id="myModal" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog" style="width: 95%;">
    <div class="modal-content animated bounceInRight">
      <div class="modal-header">
        <influunt-revisao objeto="objeto" data-ng-controller="ControladoresRevisaoCtrl" data-show-footer="false"></influunt-revisao>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-primary" data-dismiss="modal">Fechar</button>
      </div>
    </div>
  </div>
</div>
